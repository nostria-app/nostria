<div class="settings-container">
  <!-- Mobile close button (only shows on mobile when viewing details) -->
  @if (isMobile() && showDetails()) {
    <button mat-icon-button class="mobile-close-btn" (click)="goBack()" aria-label="Close settings">
      <mat-icon>close</mat-icon>
    </button>
  }

  <!-- Left sidebar with navigation options -->
  @if (!isMobile() || !showDetails()) {
    <div class="settings-sidebar">
      <h1 class="page-title" i18n="@@settings.title">Settings</h1>
      
      <!-- Search input -->
      <div class="search-container">
        <mat-form-field appearance="outline" class="search-field">
          <mat-icon matIconPrefix>search</mat-icon>
          <input 
            matInput 
            [ngModel]="searchQuery()"
            (ngModelChange)="searchQuery.set($event)"
            placeholder="Search settings..." 
            i18n-placeholder="@@settings.search.placeholder"
            autocomplete="off"
          />
          @if (searchQuery()) {
            <button mat-icon-button matIconSuffix (click)="clearSearch()" aria-label="Clear search">
              <mat-icon>close</mat-icon>
            </button>
          }
        </mat-form-field>
      </div>

      <mat-nav-list>
        @for (section of filteredSections(); track section.id) {
          @if (section.premium) {
            @if (accountState.hasActiveSubscription()) {
              <a
                mat-list-item
                [class.active]="activeSection() === section.id"
                (click)="selectSection(section.id)"
              >
                <mat-icon matListItemIcon>{{ section.icon }}</mat-icon>
                <span matListItemTitle>{{ section.title }}</span>
              </a>
            }
          } @else if (section.authenticated && app.authenticated()) {
            <a
              mat-list-item
              [class.active]="activeSection() === section.id"
              (click)="selectSection(section.id)"
            >
              <mat-icon matListItemIcon>{{ section.icon }}</mat-icon>
              <span matListItemTitle>{{ section.title }}</span>
            </a>
          } @else if (!section.authenticated) {
            <a
              mat-list-item
              [class.active]="activeSection() === section.id"
              (click)="selectSection(section.id)"
            >
              <mat-icon matListItemIcon>{{ section.icon }}</mat-icon>
              <span matListItemTitle>{{ section.title }}</span>
            </a>
          }
        }
        @if (filteredSections().length === 0) {
          <div class="no-results">
            <mat-icon>search_off</mat-icon>
            <p i18n="@@settings.search.no-results">No settings found</p>
          </div>
        }
      </mat-nav-list>
    </div>
  }

  <!-- Right content area showing the selected section details -->
  @if (!isMobile() || showDetails()) {
    <div class="settings-content">
      <router-outlet></router-outlet>
    </div>
  }
</div>
