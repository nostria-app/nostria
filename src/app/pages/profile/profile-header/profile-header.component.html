<div class="profile-header-container" [class.compact]="isCompactHeader()">
    @if (profile(); as profile) {
    <div class="profile-banner"
        [style.background-image]="profile.content.banner ? 'url(' + profile.content.banner + ')' : getDefaultBanner()">
        <button mat-icon-button class="profile-menu-button" [matMenuTriggerFor]="profileMenu">
            <mat-icon>more_vert</mat-icon>
        </button>
    </div>
    <div class="profile-info-container">
        <div class="profile-avatar" [class.clickable]="profile.content.picture"
            (click)="profile.content.picture && layout.openProfilePicture(profile)">
            @if (profile.content.picture) {
            <img [src]="profile.content.picture" alt="Profile picture" class="avatar-image">
            } @else {
            <mat-icon class="default-avatar">account_circle</mat-icon>
            }
        </div>

        <div class="profile-info" [class.compact]="isCompactHeader()">
            <h1 class="profile-name">{{ name() }}</h1>

            <div class="profile-item" title="{{ npub() }}">
                <mat-icon>key</mat-icon>
                <span>{{ npub() }}</span>
            </div>

            @if (profile.content.website) {
            <div class="profile-item" title="{{ profile.content.website }}">
                <mat-icon>link</mat-icon>
                <span><a [href]="profile.content.website" target="_blank">{{ profile.content.website}}</a></span>
            </div>
            }

            @if (!isCompactHeader() && profile.content.about) {
            <div class="profile-bio">
                {{ profile.content.about }}
            </div>
            }

            <mat-menu #profileMenu="matMenu">
                @if (!isOwnProfile()) {
                <button mat-menu-item (click)="followUser()">
                    <mat-icon>person_add</mat-icon>
                    <span>Follow</span>
                </button>
                <button mat-menu-item (click)="unfollowUser()">
                    <mat-icon>person_remove</mat-icon>
                    <span>Unfollow</span>
                </button>
                }

                <button mat-menu-item [matMenuTriggerFor]="copyMenu">
                    <mat-icon>content_copy</mat-icon>
                    <span>Copy</span>
                </button>

                <button mat-menu-item [matMenuTriggerFor]="shareMenu">
                    <mat-icon>share</mat-icon>
                    <span>Share</span>
                </button>

                @if (!isOwnProfile()) {
                <mat-divider></mat-divider>
                <button mat-menu-item (click)="muteUser()">
                    <mat-icon>notifications_off</mat-icon>
                    <span>Mute</span>
                </button>
                <button mat-menu-item (click)="blockUser()">
                    <mat-icon>block</mat-icon>
                    <span>Block</span>
                </button>
                }
            </mat-menu>

            <mat-menu #copyMenu="matMenu">
                <button mat-menu-item (click)="layout.copyToClipboard(this.npub(), 'npub')">
                    <span>Identifier (npub)</span>
                </button>
                <button mat-menu-item (click)="layout.copyToClipboard(this.npub(), 'nprofile')">
                    <span>Identifier (nprofile)</span>
                </button>
                <button mat-menu-item (click)="copyProfileData()">
                    <span>Profile Data</span>
                </button>
                <button mat-menu-item (click)="copyFollowingList()">
                    <span>Following List</span>
                </button>
                <button mat-menu-item (click)="copyRelayList()">
                    <span>Relay List</span>
                </button>
            </mat-menu>

            <mat-menu #shareMenu="matMenu">
                <button mat-menu-item (click)="layout.shareProfile(this.npub(), this.name())">
                    <span>Profile</span>
                </button>
                <button mat-menu-item (click)="layout.shareProfileUrl(this.npub())">
                    <span>Profile URL</span>
                </button>
            </mat-menu>
        </div>

    </div>

    }
</div>