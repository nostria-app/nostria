<div class="tab-content">
  <div class="notes-container">
    <div class="notes-list-container">
      @if (profileState.isInitiallyLoading() && profileState.displayedTimeline().length === 0) {
      <div class="loading-state">
        <mat-spinner [diameter]="40"></mat-spinner>
        <p>Loading timeline...</p>
      </div>
      } @else if (error()) {
      <div class="error-state">
        <mat-icon>error</mat-icon>
        <p>{{ error() }}</p>
      </div>
      } @else {

      <!-- Pinned Notes Section - Show regardless of timeline content -->
      @if (pinnedNotes().length > 0) {
      <div class="pinned-notes-section">
        <div class="pinned-notes-header">
          <mat-icon class="pin-icon">push_pin</mat-icon>
          <h3>Pinned</h3>
        </div>
        <div class="pinned-notes-container">
          @for (note of pinnedNotes(); track note.event.id) {
          <div class="pinned-note-wrapper">
            <app-event [event]="note.event" appearance="plain" [compact]="true" [hideParentEvent]="true"></app-event>
          </div>
          }
        </div>
      </div>
      }

      @if (profileState.displayedTimeline().length === 0) {
      <div class="empty-state">
        <mat-icon>timeline</mat-icon>
        <p>No timeline content to display yet</p>
      </div>
      } @else {

      <div class="notes-list">
        @for (item of profileState.displayedTimeline(); track item.event.id) {
        <app-event [event]="item.event" appearance="plain"></app-event>
        }

        <!-- Loading more indicator -->
        @if (profileState.isLoadingMoreNotes()) {
        <div class="loading-more-indicator">
          <mat-spinner diameter="24"></mat-spinner>
          <p>Loading more content...</p>
        </div>
        }

        <!-- No more notes indicator -->
        @if (!profileState.hasMoreNotes() && !profileState.hasMoreToDisplay() && profileState.displayedTimeline().length > 0) {
        <div class="no-more-indicator">
          <mat-icon>inbox</mat-icon>
          <p>You've reached the end</p>
        </div>
        }
      </div>
      }

      }
    </div>
  </div>
</div>