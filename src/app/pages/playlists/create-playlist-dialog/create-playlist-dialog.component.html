<h2 mat-dialog-title>Create New Playlist</h2>

<mat-dialog-content>
  <form [formGroup]="playlistForm" class="playlist-form">

    <div class="rss-section">
      <mat-form-field appearance="outline" class="full-width">
        <mat-label>Import from RSS Feed (Optional)</mat-label>
        <input matInput formControlName="rssUrl" placeholder="https://example.com/feed.xml" autocomplete="off"
          (keydown.enter)="fetchRss()" (blur)="fetchRss()">
        <button type="button" mat-icon-button matSuffix (click)="fetchRss()" [disabled]="isParsingRss()"
          matTooltip="Fetch RSS">
          @if (isParsingRss()) {
          <mat-spinner diameter="20"></mat-spinner>
          } @else {
          <mat-icon>rss_feed</mat-icon>
          }
        </button>
      </mat-form-field>
    </div>

    <div class="id-field-container">
      <mat-form-field appearance="outline" class="id-field">
        <mat-label>Playlist ID (d tag)</mat-label>
        <input matInput formControlName="id" placeholder="unique-playlist-id" autocomplete="off">
        @if (playlistForm.get('id')?.hasError('required')) {
        <mat-error>Playlist ID is required</mat-error>
        }
        <mat-hint>Unique identifier for this playlist (used in Nostr events)</mat-hint>
      </mat-form-field>
      <button type="button" mat-icon-button (click)="generateRandomId()" matTooltip="Generate random ID"
        class="generate-id-button">
        <mat-icon>casino</mat-icon>
      </button>
    </div>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Playlist Title</mat-label>
      <input matInput formControlName="title" placeholder="Enter playlist title" autocomplete="off">
      @if (playlistForm.get('title')?.hasError('required')) {
      <mat-error>Playlist title is required</mat-error>
      }
    </mat-form-field>

    <mat-form-field appearance="outline" class="full-width">
      <mat-label>Description (Optional)</mat-label>
      <textarea matInput formControlName="description" placeholder="Enter playlist description" rows="3"
        autocomplete="off">
      </textarea>
    </mat-form-field>
  </form>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-button type="button" (click)="onCancel()">Cancel</button>
  <button mat-flat-button color="primary" type="submit" (click)="onSubmit()" [disabled]="!playlistForm.valid">
    Create Playlist
  </button>
</mat-dialog-actions>