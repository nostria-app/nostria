<div class="category-container">
  <!-- Header -->
  <header class="category-header" [style.background]="category()?.gradient">
    <div class="header-content">
      <button mat-icon-button class="back-button" (click)="goBack()">
        <mat-icon>arrow_back</mat-icon>
      </button>
      <div class="header-icon">
        <mat-icon>{{ category()?.icon }}</mat-icon>
      </div>
      <div class="header-text">
        <h1>{{ category()?.title }}</h1>
        <p>{{ category()?.description }}</p>
      </div>
    </div>
  </header>

  <!-- Loading State -->
  @if (loading()) {
  <div class="loading-container">
    <mat-spinner diameter="40"></mat-spinner>
    <p>Loading curated content...</p>
  </div>
  }

  <!-- Error State -->
  @if (error()) {
  <div class="error-container">
    <mat-icon>error_outline</mat-icon>
    <p>{{ error() }}</p>
    <button mat-flat-button (click)="goBack()">Go Back</button>
  </div>
  }

  <!-- Content -->
  @if (!loading() && !error()) {
  <div class="category-content">
    <!-- Creators Section -->
    @if (creators().length > 0) {
    <section class="content-section">
      <h2 class="section-title">
        <mat-icon>person</mat-icon>
        {{ specialSectionTitle() }}
      </h2>
      <div class="creators-grid">
        @for (creator of creators(); track creator.pubkey) {
        <app-user-profile [pubkey]="creator.pubkey" [view]="'grid'"></app-user-profile>
        }
      </div>
    </section>
    }

    <!-- Articles Section -->
    @if (articles().length > 0) {
    <section class="content-section">
      <h2 class="section-title">
        <mat-icon>article</mat-icon>
        Curated Articles
      </h2>
      <div class="articles-grid">
        @for (article of articles(); track article.id) {
        <app-article [pubkey]="article.pubkey" [kind]="article.kind" [slug]="article.slug"
          [relayHints]="article.relayHints" mode="card" [showAuthor]="true" [showMetadata]="true">
        </app-article>
        }
      </div>
    </section>
    }

    <!-- Events Section -->
    @if (events().length > 0) {
    <section class="content-section">
      <h2 class="section-title">
        <mat-icon>event</mat-icon>
        Curated Events
      </h2>
      <div class="events-grid">
        @for (event of events(); track event.id) {
        <app-event [id]="event.id" type="e" [compact]="true" [hideComments]="true" [hideFooter]="true"
          appearance="card">
        </app-event>
        }
      </div>
    </section>
    }

    <!-- Videos/Media Section -->
    @if (videos().length > 0) {
    <section class="content-section">
      <h2 class="section-title">
        <mat-icon>video_library</mat-icon>
        Curated Videos
      </h2>
      <div class="videos-grid">
        @for (video of videos(); track video.id) {
        <button class="video-card" (click)="viewVideo(video)">
          <div class="video-thumbnail">
            @if (video.image) {
            <img [src]="video.image" [alt]="video.title || 'Video'" title="Video thumbnail" />
            } @else {
            <div class="video-placeholder">
              <mat-icon>play_circle</mat-icon>
            </div>
            }
            <div class="play-overlay">
              <mat-icon>play_arrow</mat-icon>
            </div>
          </div>
          <div class="video-info">
            <h3 class="video-title">{{ video.title || 'Untitled' }}</h3>
            <div class="video-meta">
              <app-user-profile [pubkey]="video.pubkey" [view]="'compact'"></app-user-profile>
            </div>
          </div>
        </button>
        }
      </div>
    </section>
    }

    <!-- Pictures Section -->
    @if (pictures().length > 0) {
    <section class="content-section">
      <h2 class="section-title">
        <mat-icon>photo_library</mat-icon>
        Curated Pictures
      </h2>
      <div class="pictures-grid">
        @for (picture of pictures(); track picture.id) {
        <app-event [id]="picture.id" type="e" [compact]="true" [hideComments]="true" [hideFooter]="true"
          appearance="card">
        </app-event>
        }
      </div>
    </section>
    }

    <!-- Empty State -->
    @if (creators().length === 0 && articles().length === 0 && events().length === 0 && videos().length === 0 &&
    pictures().length === 0) {
    <div class="empty-state">
      <mat-icon>explore_off</mat-icon>
      <h3>No curated content yet</h3>
      <p>We're working on curating amazing content for this category. Check back soon!</p>
      <button mat-flat-button (click)="goBack()">Browse Other Categories</button>
    </div>
    }
  </div>
  }
</div>