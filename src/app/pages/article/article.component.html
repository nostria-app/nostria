<!-- Panel Header - Fixed at top -->
<div class="panel-header">
  <button mat-icon-button class="back-button" (click)="goBack()" matTooltip="Go back">
    <mat-icon>arrow_back</mat-icon>
  </button>
  <h2 class="panel-title title-font">{{ title() || 'Addressable Event' }}</h2>
  <span class="panel-header-spacer"></span>

  @if (event()) {
  @if (isLongFormArticle() && accountState.isCurrentUser(authorPubkey())) {
  <button mat-icon-button (click)="layout.createArticle(link)" matTooltip="Edit Article">
    <mat-icon>edit</mat-icon>
  </button>
  }
  <button mat-icon-button (click)="bookmarkArticle()"
    [matTooltip]="bookmark.isBookmarkedInAnyList(id(), 'a') ? 'Manage bookmarks' : 'Add to bookmark list'">
    <mat-icon>{{ bookmark.getBookmarkIcon(id(), 'a') }}</mat-icon>
  </button>
  <button mat-icon-button (click)="shareArticle()" matTooltip="Share Event">
    <mat-icon>share</mat-icon>
  </button>
  <app-zap-button [event]="event()!"></app-zap-button>
  <app-event-menu [event]="event()!" [view]="'icon'"></app-event-menu>
  }
</div>

@let article = event();

@if (isLoading()) {
<!-- Loading State -->
<div class="article-loading">
  <mat-card>
    <mat-card-content>
      <div class="loading-content">
        <mat-progress-spinner diameter="40" mode="indeterminate"></mat-progress-spinner>
        <h2>Loading Event...</h2>
        <p>Please wait while we fetch the content.</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>
} @else if (error()) {
<!-- Error State -->
<div class="article-error">
  <mat-card>
    <mat-card-content>
      <div class="error-content">
        <mat-icon>error_outline</mat-icon>
        <h2>Unable to Load Event</h2>
        <p>{{ error() }}</p>
        <button mat-raised-button color="primary" (click)="retryLoad()">
          <mat-icon>refresh</mat-icon>
          Try Again
        </button>
      </div>
    </mat-card-content>
  </mat-card>
</div>
} @else if (article) {
<div class="article-container">
  @if (isLongFormArticle()) {
  <app-article-display [article]="articleData()" mode="full" [showTopActions]="false" (share)="shareArticle()"
    (bookmarkClick)="bookmarkArticle()" (replyClick)="scrollToComments()"></app-article-display>
  } @else {
  <app-event [event]="article" appearance="plain" [navigationDisabled]="true" mode="thread"></app-event>
  }
</div>
} @else {
<!-- Loading or Empty State -->
<div class="article-empty-state">
  <mat-card>
    <mat-card-content>
      <div class="empty-state-content">
        <mat-icon>article</mat-icon>
        <h2>No Event Selected</h2>
        <p>Please select an addressable event to view its content.</p>
      </div>
    </mat-card-content>
  </mat-card>
</div>
}