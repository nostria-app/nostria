<div class="welcome" [attr.data-step]="currentWizardStep()">
  <div class="welcome-backdrop">
    <!-- Animated background elements -->
    <div class="bg-decoration">
      <div class="bg-circle bg-circle-1"></div>
      <div class="bg-circle bg-circle-2"></div>
      <div class="bg-circle bg-circle-3"></div>
    </div>

    <div class="welcome-top">
      <button class="welcome-theme-button" mat-icon-button (click)="themeService.toggleDarkMode()">
        @if (themeService.darkMode()) {
          <mat-icon>dark_mode</mat-icon>
        } @else {
          <mat-icon>light_mode</mat-icon>
        }
      </button>
      <button class="welcome-close-button" mat-icon-button (click)="skipToEnd()">
        <mat-icon>close</mat-icon>
      </button>
    </div>

    <div class="welcome-content">
      <div class="welcome-content-container">
        @let currentStep = getCurrentStep();

        <!-- Step Icon Card -->
        <div class="welcome-icon-section">
          <div class="icon-card" [attr.data-color]="currentStep.color">
            <div class="icon-glow"></div>
            <mat-icon class="step-icon">{{ currentStep.icon }}</mat-icon>
          </div>
          
          <!-- Step Progress Dots -->
          <div class="step-dots">
            @for (step of wizardSteps(); track step.id) {
              <button 
                class="step-dot" 
                [class.active]="step.id === currentWizardStep()"
                [class.completed]="step.id < currentWizardStep()"
                (click)="goToStep(step.id)"
                [attr.data-color]="step.color">
              </button>
            }
          </div>
        </div>

        <!-- Step Content -->
        <div class="wizard-step-content">
          <div class="step-header">
            <h1>{{ currentStep.title }}</h1>
            <div class="step-subtitle">{{ currentStep.subtitle }}</div>
          </div>

          <div class="step-body">
            @for (paragraph of currentStep.content; track $index) {
              <p>{{ paragraph }}</p>
            }
          </div>

          <!-- Features Grid -->
          @if (currentStep.features.length > 0) {
            <div class="features-grid">
              @for (feature of currentStep.features; track feature.icon) {
                <div class="feature-card" [attr.data-color]="currentStep.color">
                  <div class="feature-icon-wrapper">
                    <mat-icon class="feature-icon">{{ feature.icon }}</mat-icon>
                  </div>
                  <span class="feature-text">{{ feature.text }}</span>
                </div>
              }
            </div>
          }
        </div>
      </div>
    </div>

    <div class="welcome-footer">
      <div class="step-indicator">
        <span class="step-current">{{ currentWizardStep() }}</span>
        <span class="step-separator">/</span>
        <span class="step-total">{{ totalWizardSteps() }}</span>
      </div>

      <div class="welcome-actions">
        @if (currentWizardStep() === 1) {
          <button mat-flat-button class="action-btn primary-btn" (click)="nextStep()">
            <span>Get Started</span>
            <mat-icon>arrow_forward</mat-icon>
          </button>
        } @else if (currentWizardStep() === totalWizardSteps()) {
          <button mat-button class="action-btn back-btn" (click)="previousStep()">
            <mat-icon>arrow_back</mat-icon>
            <span>Back</span>
          </button>
          <button mat-flat-button class="action-btn primary-btn" (click)="completeWizard()">
            <span>Start Using Nostria</span>
            <mat-icon>rocket_launch</mat-icon>
          </button>
        } @else {
          <button mat-button class="action-btn back-btn" (click)="previousStep()">
            <mat-icon>arrow_back</mat-icon>
            <span>Back</span>
          </button>
          <button mat-flat-button class="action-btn primary-btn" (click)="nextStep()">
            <span>Continue</span>
            <mat-icon>arrow_forward</mat-icon>
          </button>
        }
      </div>
    </div>
  </div>
</div>
