<div class="content-container" #contentContainer>
  @if (shouldShowContent()) {
  <app-note-content [contentTokens]="contentTokens()" [authorPubkey]="event()?.pubkey"></app-note-content>

  @for (mention of eventMentions(); track mention.eventId) {
  @if (mention.loading) {
  <!-- Loading placeholder for event mention -->
  <mat-card appearance="outlined" class="event-mention-card loading-card">
    <mat-card-content>
      <div class="event-loading-placeholder">
        <mat-spinner diameter="24"></mat-spinner>
        <span class="loading-text">Loading referenced event...</span>
      </div>
    </mat-card-content>
  </mat-card>
  } @else if (mention.event) {
  @if (mention.event.event.kind === 8) {
  <!-- Badge Award (kind 8) -->
  <app-badge [badge]="mention.event.event"></app-badge>
  } @else {
  <!-- Regular event mention -->
  <mat-card appearance="outlined" class="event-mention-card" tabindex="0" role="button"
    (click)="onEventMentionClick($event, mention.event.event)"
    (keydown.enter)="onEventMentionClick($event, mention.event.event)"
    (keydown.space)="onEventMentionClick($event, mention.event.event)">
    <mat-card-header>
      <app-user-profile [pubkey]="mention.event.event.pubkey" view="compact">
        <span class="date-link" [matTooltip]="mention.event.event.created_at * 1000 | date: 'medium'"
          matTooltipPosition="below">
          {{ mention.event.event.created_at | ago }}
        </span>
      </app-user-profile>
    </mat-card-header>
    <mat-card-content>
      <div class="content-container">
        <app-note-content [contentTokens]="mention.contentTokens"
          [authorPubkey]="mention.event.event.pubkey"></app-note-content>
      </div>
    </mat-card-content>
  </mat-card>
  }
  } @else {
  <!-- Event not found placeholder -->
  <mat-card appearance="outlined" class="event-mention-card not-found-card">
    <mat-card-content>
      <div class="event-not-found-placeholder">
        <span class="not-found-text">Unable to load referenced event</span>
      </div>
    </mat-card-content>
  </mat-card>
  }
  }

  @for (preview of socialPreviews(); track preview.url) {
  @if (settings.settings().socialSharingPreview) {
  <app-social-preview class="social-preview" [url]="preview.url"></app-social-preview>
  }
  }

  <!-- Tagged references (mentions and articles) -->
  @if (event()) {
  <app-tagged-references [event]="event()!"></app-tagged-references>
  }
  } @else {
  <div class="content-placeholder"></div>
  }
</div>