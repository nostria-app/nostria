<div class="content-container" #contentContainer>
  @if (shouldShowContent()) {
  <app-note-content [contentTokens]="contentTokens()" [authorPubkey]="event()?.pubkey"></app-note-content>

  @for (mention of eventMentions(); track mention.eventId) {
  @if (mention.loading) {
  <!-- Loading placeholder for event mention -->
  <mat-card appearance="outlined" class="event-mention-card loading-card">
    <mat-card-header class="loading-header">
      <div class="skeleton-avatar"></div>
      <div class="skeleton-text-container">
        <div class="skeleton-text skeleton-name"></div>
        <div class="skeleton-text skeleton-date"></div>
      </div>
    </mat-card-header>
    <mat-card-content>
      <div class="skeleton-content">
        <div class="skeleton-text skeleton-line"></div>
        <div class="skeleton-text skeleton-line short"></div>
      </div>
    </mat-card-content>
  </mat-card>
  } @else if (mention.event) {
  @if (mention.event.event.kind === 8) {
  <!-- Badge Award (kind 8) -->
  <app-badge [badge]="mention.event.event"></app-badge>
  } @else {
  <!-- Regular event mention -->
  <mat-card appearance="outlined" class="event-mention-card" tabindex="0" role="button"
    (click)="onEventMentionClick($event, mention.event.event)"
    (keydown.enter)="onEventMentionClick($event, mention.event.event)"
    (keydown.space)="onEventMentionClick($event, mention.event.event)">
    <mat-card-header>
      <app-user-profile [pubkey]="mention.event.event.pubkey" view="compact">
        <span class="date-link" [matTooltip]="mention.event.event.created_at * 1000 | date: 'medium'"
          matTooltipPosition="below">
          {{ mention.event.event.created_at | ago }}
        </span>
      </app-user-profile>
    </mat-card-header>
    <mat-card-content>
      <div class="content-container">
        <app-note-content [contentTokens]="mention.contentTokens"
          [authorPubkey]="mention.event.event.pubkey"></app-note-content>
      </div>
    </mat-card-content>
  </mat-card>
  }
  } @else {
  <!-- Event not found placeholder -->
  <mat-card appearance="outlined" class="event-mention-card not-found-card">
    <mat-card-content>
      <div class="event-not-found-placeholder">
        <mat-icon>link_off</mat-icon>
        <span class="not-found-text">Referenced event not found</span>
      </div>
    </mat-card-content>
  </mat-card>
  }
  }

  @for (article of articleMentions(); track article.identifier + article.pubkey) {
  <app-article [slug]="article.identifier" [pubkey]="article.pubkey" [kind]="article.kind"
    [relayHints]="article.relayHints" mode="compact" [showAuthor]="true" [showMetadata]="true"
    [clickable]="true"></app-article>
  }

  @for (preview of socialPreviews(); track preview.url) {
  @if (settings.settings().socialSharingPreview) {
  <app-social-preview class="social-preview" [url]="preview.url"></app-social-preview>
  }
  }

  <!-- Tagged references (mentions and articles) - hidden when in comment context -->
  @if (event() && !hideTaggedReferences()) {
  <app-tagged-references [event]="event()!"></app-tagged-references>
  }
  } @else {
  <div class="content-placeholder"></div>
  }
</div>