<div class="followset-container">
  <div class="followset-header">
    <h1>{{ title() }}</h1>
    <p>{{ description() }}</p>
  </div>

  <div class="interests-selection">
    <h3>Pick your interests:</h3>
    @if (isLoadingInterests()) {
    <div class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading starter packs...</p>
    </div>
    } @else if (availableInterests().length === 0) {
    <div class="empty-state">
      <p>No starter packs available at the moment.</p>
    </div>
    } @else {
    <div class="interests-grid">
      @for (interest of availableInterests(); track interest.id) {
      <label class="interest-checkbox">
        <input type="checkbox" [checked]="selectedInterests().includes(interest.id)"
          (change)="toggleInterest(interest.id)" />
        <span class="interest-label">
          <mat-icon>{{ interest.icon }}</mat-icon>
          {{ interest.name }}
        </span>
      </label>
      }
    </div>
    }
  </div>

  @if (selectedInterests().length > 0) {
  <div class="suggested-follows">
    <h3>People to follow</h3>
    <p>Here are some popular creators in your areas of interest:</p>

    @if (isLoadingProfiles()) {
    <div class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading profiles...</p>
    </div>
    } @else {
    <div class="profiles-grid">
      @for (profile of filteredProfiles(); track profile.id) {
      <div class="profile-card" [class.following]="followingProfiles().includes(profile.id)">
        <a class="profile-avatar" [routerLink]="[{ outlets: { right: ['p', profile.id] } }]">
          <img [src]="getOptimizedImageUrl(profile.avatar)" [alt]="profile.name + ' avatar'" [title]="profile.name" />
        </a>
        <div class="profile-info">
          <h4><a [routerLink]="[{ outlets: { right: ['p', profile.id] } }]">{{ profile.name }}</a></h4>
          <p class="profile-bio">{{ profile.bio }}</p>
          @if (profile.region && profile.interests.includes('regional')) {
          <p class="profile-region">üìç {{ profile.region }}</p>
          }
          <div class="profile-interests">
            @for (interestId of profile.interests; track interestId) {
            <span class="interest-tag">{{ getInterestName(interestId) }}</span>
            }
          </div>
        </div>
        <button mat-button [class.following-btn]="followingProfiles().includes(profile.id)"
          (click)="toggleFollow(profile.id)" [disabled]="followingProfiles().includes(profile.id)">
          @if (followingProfiles().includes(profile.id)) {
          <ng-container> <mat-icon>check</mat-icon> Following </ng-container>
          } @else {
          <ng-container> <mat-icon>person_add</mat-icon> Follow </ng-container>
          }
        </button>
      </div>
      }
    </div>
    }
  </div>
  }
</div>