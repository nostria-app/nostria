<div class="inline-video-container" [class.fill-container]="fillContainer()" (click)="$event.stopPropagation()">
  <video #videoElement class="video-element" [src]="effectiveSrc()" [poster]="poster()" [muted]="shouldBeMuted()"
    [loop]="loop()" playsinline preload="metadata" (loadedmetadata)="onVideoElementReady()" [class.blurred]="blurred()"
    [class.fill-container]="fillContainer()" [style.object-fit]="effectiveObjectFit()" (click)="onVideoClick()"
    (dblclick)="onVideoDoubleClick($event)"></video>

  <!-- Error overlay - shown when video fails to load -->
  @if (hasError()) {
  <div class="error-overlay">
    <mat-icon>error_outline</mat-icon>
    <span>Video failed to load</span>
    <a [href]="src()" target="_blank" rel="noopener noreferrer" class="open-link">
      Open in new tab
    </a>
  </div>
  }

  <!-- Video Controls - unified UI component -->
  @if (!hasError()) {
  <app-video-controls [videoElement]="videoElementSignal()" [config]="effectiveControlsConfig()"
    (playPause)="togglePlay()" (seek)="onSeek($event)" (volumeChange)="onVolumeChange($event)"
    (muteToggle)="onMuteToggle()" (playbackRateChange)="onPlaybackRateChange($event)"
    (fullscreenToggle)="toggleFullscreen()" (pipToggle)="pictureInPicture()" (castToggle)="castToDevice()" />
  }
</div>