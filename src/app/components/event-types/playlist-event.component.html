@if (hasContentWarning()) {
<div class="content-warning">
  <mat-icon>warning</mat-icon>
  <span>{{ contentWarning() }}</span>
</div>
}

@let playlist = playlistData();
@if (playlist) {
<div class="playlist-container">
  <!-- <app-user-profile class="user-profile-name-right" [hostWidthAuto]="true" [pubkey]="event().pubkey"
    view="tiny"></app-user-profile> -->
  <div class="playlist-header">
    <mat-icon class="playlist-icon">playlist_play</mat-icon>
    <div class="playlist-info">
      <h3 class="playlist-title">{{ playlist.title }}</h3>
      @if (playlist.alt) {
      <p class="playlist-descriptor">{{ playlist.alt }}</p>
      }
      <div class="playlist-meta">
        <span class="track-count">{{ trackEvents().length }} tracks</span>
        @if (playlist.totalDuration) {
        <span class="playlist-duration">{{ playlist.totalDuration }}</span>
        }
      </div>
    </div>
  </div>

  <div class="playlist-actions">
    <button mat-flat-button color="primary" (click)="playPlaylist(playlist)">
      <mat-icon>play_arrow</mat-icon>
      Play Playlist
    </button>
    <button mat-button (click)="addPlaylistToQueue(playlist)">
      <mat-icon>playlist_add</mat-icon>
      Add to Queue
    </button>
    <button mat-button (click)="toggleSavePlaylist()"
      [matTooltip]="isSaved() ? 'Remove from saved playlists' : 'Save playlist to bookmarks'">
      <mat-icon>{{ isSaved() ? 'bookmark' : 'bookmark_border' }}</mat-icon>
      {{ isSaved() ? 'Saved' : 'Save' }}
    </button>
    <button mat-button (click)="downloadM3U()" title="Download M3U file">
      <mat-icon>download</mat-icon>
      Download .m3u
    </button>
    @if (playlist.url) {
    <a mat-icon-button [href]="playlist.url" target="_blank" rel="noopener noreferrer" title="Download playlist">
      <mat-icon>link</mat-icon>
    </a>
    }
  </div>

  @if (trackEvents().length > 0 || loadingTracks()) {
  <div class="playlist-tracks">
    <h4 class="tracks-header">Tracks</h4>
    @if (loadingTracks()) {
    <div class="loading-tracks">
      <mat-spinner diameter="32"></mat-spinner>
      <span>Loading tracks...</span>
    </div>
    } @else if (trackEvents().length > 0) {
    <div class="track-list">
      @for (trackEvent of trackEvents(); track trackEvent.id) {
      <app-music-event [event]="trackEvent" mode="list"></app-music-event>
      }
    </div>
    } @else {
    <div class="no-tracks">
      <span>No tracks available</span>
    </div>
    }
  </div>
  }
</div>
}
<!-- NIP-22 Comments Section -->
<app-comments-list [event]="event()"></app-comments-list>