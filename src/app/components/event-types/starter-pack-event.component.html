@if (mode() === 'compact') {
<mat-card class="starter-pack-compact" (click)="openStarterPack()" (keydown.enter)="openStarterPack()"
  (keydown.space)="openStarterPack()" tabindex="0" role="button" title="Open starter pack"
  [attr.aria-label]="'Open starter pack'">
  @if (image()) {
  <div class="starter-pack-compact-image-wrap">
    <img [src]="image()" [alt]="title() + ' banner'" title="Starter pack banner" class="starter-pack-compact-image"
      loading="lazy" />
  </div>
  }
  <div class="starter-pack-compact-content">
    <div class="starter-pack-compact-header-row">
      <h3 class="starter-pack-compact-title">{{ title() }}</h3>
      <div class="starter-pack-compact-stats" aria-label="Starter pack member count">
        <mat-icon>people</mat-icon>
        <span class="count-value">{{ userCount() }}</span>
        <span class="count-label">{{ userCount() === 1 ? 'user' : 'users' }}</span>
      </div>
    </div>
  </div>
</mat-card>
} @else {
<div class="starter-pack-container">
  <div class="starter-pack-header">
    <div class="starter-pack-title-row">
      <h3 class="starter-pack-title">{{ title() }}</h3>
      <div class="starter-pack-header-right">
        <div class="starter-pack-count-pill" aria-label="Starter pack member count">
          <mat-icon>people</mat-icon>
          <span class="count-value">{{ userCount() }}</span>
          <span class="count-label">{{ userCount() === 1 ? 'user' : 'users' }}</span>
        </div>
        <div class="starter-pack-actions" (click)="$event.stopPropagation()">
          <button mat-stroked-button (click)="followAll($event)" [disabled]="isFollowingAll() || userCount() === 0"
            matTooltip="Follow everyone in this starter pack">
            @if (isFollowingAll()) {
            <mat-spinner diameter="18"></mat-spinner>
            } @else {
            <mat-icon>person_add</mat-icon>
            }
            <span>Follow All</span>
          </button>

          <button mat-stroked-button [matMenuTriggerFor]="addToListMenu"
            [disabled]="isAddingToList() || userCount() === 0" matTooltip="Add all profiles to a people list">
            @if (isAddingToList()) {
            <mat-spinner diameter="18"></mat-spinner>
            } @else {
            <mat-icon>group_add</mat-icon>
            }
            <span>Add to list</span>
          </button>
        </div>
      </div>
    </div>

    <mat-menu #addToListMenu="matMenu">
      @for (set of availableFollowSets(); track set.id) {
      <button mat-menu-item (click)="addAllToFollowSet(set.dTag, $event)">
        <mat-icon>playlist_add</mat-icon>
        <span>{{ set.title }}</span>
      </button>
      }
      <button mat-menu-item (click)="createListAndAddAll($event)">
        <mat-icon>add_circle</mat-icon>
        <span>Create new list</span>
      </button>
    </mat-menu>

    @if (image()) {
    <div class="starter-pack-banner">
      <img [src]="image()" [alt]="title() + ' banner'" title="Starter pack banner" class="banner-image"
        loading="lazy" />
    </div>
    }
  </div>

  <div class="starter-pack-content">
    @if (publicKeys().length > 0) {
    <div class="users-section">
      <h4 class="section-title">
        <mat-icon>people</mat-icon>
        Recommended Users ({{ publicKeys().length }})
      </h4>

      <div class="users-grid">
        @for (pubkey of publicKeys(); track pubkey) {
        <div class="user-item">
          <div class="user-content" (click)="navigateToProfile(pubkey)" (keyup.enter)="navigateToProfile(pubkey)"
            (keyup.space)="navigateToProfile(pubkey)" tabindex="0" role="button" title="View profile"
            [attr.aria-label]="'View profile'">
            <app-user-profile [pubkey]="pubkey" [view]="'grid'"></app-user-profile>
          </div>
          <div class="user-actions">
            @if (!isFollowing(pubkey)) {
            <button mat-mini-fab color="primary" class="follow-button" (click)="followUser(pubkey, $event)"
              [attr.aria-label]="'Follow user'" matTooltip="Follow">
              <mat-icon>person_add</mat-icon>
            </button>
            } @else {
            <button mat-mini-fab color="accent" class="follow-button following" (click)="unfollowUser(pubkey, $event)"
              [attr.aria-label]="'Unfollow user'" matTooltip="Following">
              <mat-icon>check</mat-icon>
            </button>
            }
          </div>
        </div>
        }
      </div>
    </div>
    } @else {
    <div class="empty-state">
      <mat-icon>people_outline</mat-icon>
      <p>No users in this starter pack</p>
    </div>
    }
  </div>
</div>
}